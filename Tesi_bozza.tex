\documentclass[12pt,a4paper,oneside]{book}
\linespread{1.5}
\usepackage{graphicx}
\usepackage[hang,small,bf]{caption}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage[linesnumbered,lined,boxed,commentsnumbered]{algorithm2e}
\usepackage{bytefield}
\usepackage{epstopdf}
\usepackage[italian]{babel}

\author{Luca Olivieri}
\title{Source Contact Graph Routing applicato ad una rete DTN nanosatellitare}

\bibliographystyle{IEEEtran}

\pagestyle{fancy}
\addtolength{\headwidth}{\marginparsep}
\addtolength{\headwidth}{\marginparwidth}
\renewcommand{\headrulewidth}{0.6pt}
\renewcommand{\footrulewidth}{0.6pt}
\renewcommand{\chaptermark}[1]{\markboth{ }{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\fancyfoot{}
\fancyfoot[L]{Università degli Studi di Genova}
\fancyfoot[R]{\thepage}
\renewcommand{\captionfont}{\slshape}

\begin{document}
	
	\input{copertina}
	
	\clearpage
	
	\chapter*{Ringraziamenti}	
	
	\clearpage
	
	\chapter*{Estratto}
	
	\clearpage
	
	\tableofcontents
	
	\clearpage
	
	\chapter{Introduzione}
	
	\clearpage
	
	\chapter{Delay Tolerant Networks}
		
		\section{Origini e idea generale}
		
		Le reti convenzionali mal si adattano in condizioni ambientali estreme e in recenti anni questo problema è stato oggetto di ricerca. I principali limiti dei dispositivi operanti in queste circostanze riguardano la capacità di rete limitata, la scarsa disponibilità di energia e memoria, il movimento e in particolare lunghi ritardi e connettività intermittente. Queste ultime limitazioni saranno la caratteristica principale di questo lavoro, incentrato su reti di tipo satellitare dove il costante movimento orbitale impone una connettività intermittente e la notevole distanza tra i nodi risente del limite di propagazione della luce. La comune pila ISO/OSI male si adatta a queste condizioni, soffrendo a più livelli delle peculiari caratteristiche della rete. In particolare la combinazione TCP/IP è resa inutilizzabile da questi impedimenti e questo argomento verrà approfondito nel prossimo capitolo. Varie soluzioni sono state proposte per affrontare questo problema, tra cui i Performance Enhancing Proxies (PEPs) che però, oltre a non rappresentare una vera soluzione, creano problemi di incompatibilità con gli attuali protocolli di sicurezza.
		
		Una valida soluzione alternativa è l'architettura DTN, che introduce un protocollo, chiamato Bundle Protocol (BP), sovrastante il livello di trasporto (TCP, UDP, etc..) o il livello fisico (Bluetooth, Ethernet, ...). Questa aggiunta permette la memorizzazione su lunghi periodi ai nodi intermedi, permettendo così di poter affrontare interruzioni del canale e lunghi ritardi. Dividendo il percorso end-to-end in più salti di tipo DTN si estende il concetto di TCP-splitting già utilizzato sui PEP, permettendo di usare protocolli specializzati necessari, ad esempio, sui link satellitari.
		
		\section{Limitazioni dei protocolli convenzionali in condizioni estreme}
		
		Per meglio comprendere le limitazioni che i protocolli standard di Internet hanno in condizioni di rete precarie verrà proposto un esempio. Consideriamo uno scenario composto da un centro di ricerca, un complesso di antenne e un satellite in orbita marziana. La situazione è schematizzata nella figura (ref to im). 
		
		Il percorso che divide il laboratorio dalle antenne per lo spazio profondo è una rete Internet convenzionale, caratterizzata da:
		\begin{itemize}
			\item Basse latenze, nell'ordine dei millisecondi.
			\item Alte velocità, fino a qualche Gb/s
			\item Comunicazione bidirezionale
			\item Connettività sorgente-destinazione continua
		\end{itemize}
		Quindi in questo tratto lo stack TCP/IP è usato nelle sue condizioni nominali, potendo offrendo tutti i servizi che conosciamo come frammentazione e ritrasmissione automatica. 
		
		Analizzando invece il secondo tratto di comunicazione, tra il complesso di antenne e l'orbiter marziano, ci accorgiamo che la situazione è ben diversa:
		\begin{itemize}
			\item Lunghe latenze di propagazione, nell'ordine di minuti
			\item Basse velocità, tipicamente qualche decina di Kb/s
			\item Interruzioni a causa di interferenze
			\item Connessione deterministicamente intermittente
		\end{itemize}
		Le lunghe latenze rendono inutilizzabile il meccanismo di ritrasmissione del TCP eccedendo abbondantemente i timeout propri del protocollo. Inoltre il meccanismo di handshake a tre stadi si protrarrebbe fino ad occupare gran parte dell'oportunità di contatto. Protocolli alternativi al TCP sono l'UDP, che però non offre meccanismi di ritrasmissione automatica, e altri più esotici che comunque non produrrebbero risultati soddisfacenti per le stesse ragioni del TCP.
		Risulta quindi che non è possibile usare un unico stack di protocolli su tutti i segmenti della rete, pur rimanendo nella necessità di avere un meccanismo di ritrasmissione automatico (ARQ). 
		Infine l'ultimo impedimento è la connessione intermittente che dai normali sistemi di routing è elaborata come una totale disconnessione eccedendo i tempi di timeout standard. Il nodo è quindi considerato strutturalmente perso piuttosto che in una disconnessione pianificata e di conseguenza un tipico calcolo di percorso basato su IP non è possibile.
		
		
		\section{Architettura DTN}		
		
		L'archittettura DTN è basata sull'introduzione di un nuovo strato protocollare a livello di trasporto o anche a livelli più bassi chiamato Bundle Protocol (BP). Il punto essenziale è dotare i nodi della capacità di gestire ritardi e disconnessioni, permettendo di memorizzare i dati localmente in attesa dell'opportunità per inoltrarli al prossimo nodo. 
		
		Il Bundle Protocol è in grado di interfacciarsi con i livelli inferiori, generalmente di trasporto, per mezzo di Convergence Layer Adapters (CLAs). Nel tempo sono stati definiti vari CLA, a cominciare dai protocolli di trasporto più comuni come TCP, UDP, LTP, passando poi anche nella seconda versione (DTN2) a protocolli di livello datalink come Bluetooth ed Ethernet. 
		In combinazione con il BP, ogni nodo può utilizzare il CLA più adatto per l'inoltro successivo. 
		
		L'uso del Bundle Protocol è guidato da alcuni principi di design a livello applicativo che contribuiscono ad ottenere migliori risultati:
		\begin{itemize}
			\item Gli applicativi sono tenuti a minimizzare gli scambi di andata e ritorno
			\item Gli applicativi dovrebbero essere in grado di gestire interruzioni improvvise mantenendo il trasferimento attivo
			\item Gli applicativi sono tenuti a specificare il tempo di validità dei dati e loro importanza relativa.
		\end{itemize}
		
		
		L'architettura DTN offre diverse nuove caratteristiche che saranno elencate e descritte di seguente.
		\begin{itemize}
			\item La DTN può agire come strato legante di tecnologie disomogenee, come reti wireless {\it ad hoc} di sensori, WLAN, link satellitari, internet, ecc. Affinché il BP sia correttamente gestito, sui nodi della rete è necessario che sia installato il Bundle Protocol Agent (BPA), che permetterà di dividere il percorso in vari hop DTN. Nei diversi hop potranno essere usati differenti CLA per adattarsi ai molteplici protocolli a cui una rete disomogenea può appoggiarsi. Oppure è anche possibile appoggiarsi a diverse varianti dello di un protocollo utilizzando lo stesso CLA in hop successivi. L'architettura multi-hop DTN può essere vista come una generalizzazione del TCP-splitting, aspetto che verrà approfondito nella prossima sottocapitolo.
			
			\item Possibilità di archiviazione ai nodi intermedi. Questa è un'importante differenza dallo stack TCP/IP tradizionale, dove, in presenza di reti convenzionali che assumono connettività persistente e brevi ritardi, i router intermedi trattengono l'informazione solo per brevi periodi lasciando la memorizzazione a lungo termine solo ai nodi finali. Questo è motivato dal fatto che appoggiandosi una connessione stabile si suppone che l'informazione possa essere recuperata direttamente dalla fonte. Tutto ciò ovviamente non è possibile nelle reti in condizioni estreme e, nell'ottica di riuscire ad affrontare i lunghi tempi di andata e ritorno come anche le interruzioni di canale, nelle reti DTN è necessario che i nodi intermedi abbiano la possibilità di memorizzare a lungo termine l'informazione. Questo contribuisce alla robustezza dell'architettura in presenza di disturbi, disconnessioni e problemi tecnici temporanei come ad esempio riavvi del nodo. Da un altro punto di vista però la memorizzazione a lungo termine può portare a congestionare i nodi, questa è una conseguenza da considerare e gestire.
			
			\item Tenendo a mente il contesto generale di una rete prona a non avere una connessione persistente tra sorgente e destinazione, l'architettura DTN stabilisce che il nodo avente i dati è responsabile per questi ultimi. Quindi eventuali ritrasmissioni che nelle reti convenzionali sono gestite dai nodi finali qui sono gestite da ogni singolo nodo intermedio.
			
			\item Late Binding: ogni nodo della rete DTN è identificato da un Endpoint Identifier (EID), che sintatticamente è rappresentato da un Uniform Resource Identifier (URI). Nel Bundle Protocol non esiste concetto di indirizzo, l'instradamento è basato puramente su EID. Quindi la risoluzione DNS di un nome destinazione può essere posposta (Late Binding) fino a che non si entra in contatto con la struttura necessaria e il percorso fatto finora è basato su EID. Questa è una caratteristica che permette di aggirare la mancanza di specifiche strutture come un DNS in reti isolate.
			
			\item Il routing in questa architettura deve coinvolgere priorità diverse dalle reti tradizionali, come ad esempio la capacità di memorizzazione e la gestione dell'energia. Certamente il tempo di consegna rimane un aspetto importante, ma in questo contesto può essere soggetto a compromessi. Infine il routing deve gestire il concetto di contatto, che si può definire come intervallo di tempo nel quale dei nodi possono scambiarsi dati e con una certa aspettativa di banda. La  quantificazione di tutti questi aspetti non è banale.
			
			\item L'architettura DTN definisce due tipi di frammentazione, proattiva e reattiva. La prima è adatta in situazioni dove la connessione è pianifica o deterministica (tempo di contatto) e si è a conoscenza della quantità di dati scambiabili per ogni finestra temporale (volume di contatto). Quindi quando la connessione è conosciuta a priori, come ad esempio in comunicazioni spaziali, è possibile frammentare grossi bundle pianificando con precisione i trasferimenti compatibilmente con il volume di contatto disponibile.
			Al contrario la frammentazione reattiva entra in gioco a posteriori, quando ad esempio la connessione viene interrotta frequentemente e sono necessarie ritrasmissioni.
			
			
		\end{itemize}
		
		
		\section{DTN come evoluzione del TCP splitting}
		L'accesso a internet tramite TCP/IP ha portato allo sviluppo dei PEP e in generale di {\it protocol boosters } per adattare questo stack in reti eterogenee. Il loro ruolo modifica attivamente il flusso sorgente-destinazione per adattare ai nodi TCP/IP i tratti con prestazioni povere, di fatto inducendoli a credere di avere a che fare con connessioni a prestazioni migliori. Gli esempi proposti saranno incentrati sulla comunicazione satellitare, essendo questa uno scenario di tipico utilizzo dei PEP. Il link satellitare infatti presenta forti latenze e altre peculiarità che rendono necessari protocolli specializzati come LTP. I PEP o alternativamente le DTN si occupano di spezzare la connessione a livello di trasporto (TCP) per permettere la sostituzione di quest'ultimo con LTP, ad esempio. 
		%non ho capito un accidente dei principi di fate sharing
		
		Principalmente sono possibili due configurazioni diverse di PEP: distribuiti ed integrati. I primi sono presenti da entrambi i lati del link satellitare, i secondi invece solo da un lato del link satellitare. 
		%Immagine presa dal vostro paper al riguardo
		La tipologia più comune di PEP effettua il TCP splitting, dividendo la connessione a livello di trasporto in due parti. Nei PEP distribuiti quindi si hanno tre connessioni diverse, dove la prima e l'ultima generalmente sono su TCP standard e rete cablata, mentre la seconda sul link satellitare ne usa una versione specializzata.
		Il corrispondente DTN è simile a quest'ultima configurazione, essendo che l'architettura prevede i nodi avere installata la gestione del BP.
		Nei PEP integrati invece la connessione è spezzata in sole due parti, la prima con su rete cablata con TCP convenzionale e la seconda con un protocollo specializzato che però non può essere radicalmente diverso ma compatibile con il TCP standard.
		%Immagine con i due differenti stack
		
		Riassumendo le principali similarità e differenze:
		\begin{itemize}
			\item Entrambi hanno due connessioni a livello di trasporto, una cablata e l'altra satellitare.
			\item Entrambi possono usare una variante del TCP specializzata per la connessione satellitare.
			\item La soluzione DTN richiede che i nodi abbiano installata la gestione del BP
			\item Il TCP splitting viola il principio di connessione end to end, perché i PEP agiscono sia al livello applicativo che di trasporto, facoltà in teoria riservata ai soli nodi finali. Nelle DTN questo problema è superato perché il ruolo del TCP è ridefinito essendo che ogni hop DTN è previsto sia una connessione a sé stante.
 		\end{itemize}
		
		
	
	\chapter{Nanosatellite DTN Network}
		
		\section{Framework}	

		L'idea generale su cui si basa questo lavoro è una costellazione di nanosatelliti operanti con il paradigma DTN, inizialmente sviluppata in uno scenario dove diverse orbite non interagivano \cite{cello2014hot}, limitata quindi allo stesso piano orbitale, si è evoluta poi in uno scenario tridimensionale. Il satellite diventa un contenitore di dati che con il suo movimento li trasporta fino a destinazione. In questo scenario sono possibili scambi di dati tra satelliti in orbita, ma non sono possibili contatti tra più di due satelliti. Il costo decisamente più contenuto dell'infrastruttura è la motivazione principale di una rete satellitare di questo genere, proposta come alternativa alle soluzioni commercialmente disponibili. Nei prossimi paragrafi verranno approfonditi aspetti tecnici come le diverse tipologie di satellite, orbita e infrastruttura. Infine sarà a approfondito l'uso di questa piattaforma per l'estensione della rete Internet a zone rurali.
		
		\section{Orbite e piattaforma satellitare}
		Per meglio comprendere la configurazione della nostra costellazione seguirà un breve approfondimento sulle differenti tipologie di orbita e satellite. Infine sarà esposta e motivata la nostra scelta.

			\subsection{Classificazione delle orbite}
			La meccanica orbitale di corpi naturali e artificiali è governata dalle tre leggi di Keplero. Comprendendo queste regole è possibile giustificare le caratteristiche dei differenti tipi di orbita usati per i satelliti artificiali. Le leggi sono valide nel caso la massa del corpo orbitante è trascurabile rispetto al corpo centrale e si possono trascurare le interazioni con corpi diversi oltre i due in esame. Queste approssimazioni sono valide nel nostro caso di studio e le leggi sono riformulate dal punto di vista di un satellite artificiale in orbita terrestre.
			\begin{enumerate}
				\item L'orbita di un satellite è un'ellisse con la Terra in uno dei due fuochi.
				\item Il segmento che unisce il centro della Terra con il satellite descrive aree uguali in tempi uguali.
				\item Il quadrato del tempo che il satellite impiega a percorrere l'orbita è proporzionale al cubo della distanza media dalla Terra.
			\end{enumerate}
			
			Intuitivamente la prima legge mostra come un'orbita circolare rappresenti un caso particolare di orbita e  come questo possa produrre comportamenti particolari. La seconda e terza invece legano la distanza dei due corpi a come il tempo di orbita è distribuito e a quanto ammonta, rispettivamente. Il concetto generale è quindi che più un satellite è distante più questo è lento nel procedere sulla sua orbita.
			
			La classificazione orbitale è basata sui seguenti parametri: altitudine, eccentricità, inclinazione, corpo centrale, sincronia. Sono elencati solo le classificazioni di interesse per i satelliti artificiali.
						
			{\large \bf ALTITUDINE}
			\begin{itemize}
				\item {\bf LEO - Low Earth Orbit}
				L'altitudine è compresa tra i 160km e 2000km, con orbite di circa 1-2 ore di durata. Ogni satellite compre solo una porzione della superficie terrestre quindi è necessaria una costellazione per assicurare una copertura globale. Per la relativa vicinanza alla superficie le comunicazioni sono a bassa latenza e non è necessaria grande potenza in trasmissione.
				\item {\bf MEO - Medium Earth Orbit}
				Altitudini comprese tra 5000km e 10000 km, tipicamente usate per i sistemi di posizionamento, osservazione della terra e più raramente telecomunicazioni. Il periodo orbitale è intorno alle 12 ore. Sono ancora richiesti più satelliti per una copertura globale.				
				\item {\bf GEO - Geostazionary Earh Orbit}
				Questo è un particolare tipo di orbita, posta a 35786 km sopra l'equatore, che permette di posizionare il satellite in un punto fisso rispetto alla superficie terrestre. La maggior parte dei satelliti per telecomunicazioni sfrutta questo tipo di orbita che però, data la grande distanza da terra, soffre di una lunga latenza.
			\end{itemize}
			
			{\large \bf ECCENTRICITÀ}	
			\begin{itemize}
				\item Orbita circolare, particolare caso dell'orbita ellittica, fanno parte di questo gruppo l'orbita GEO e l'orbita di trasferimento di Hoffman, usata per trasferire veicoli spaziali tra orbite diverse. In generale anche le orbite basse fanno parte di questa categoria, sempre con un certo grado di approssimazione.
				\item Orbite eccentriche, entrambe queste orbite sono usate per sistemi di comunicazione e militari, quasi esclusivamente da Russi. \begin{itemize}
					\item Molnya orbit
					\item Tundra orbit					
				\end{itemize}
				Importante notare come queste fruttino la seconda legge di Keplero per soffermarsi per più tempo possibile sopra una specifica zona terrestre. Infatti con una forte eccentricità si ha che il satellite trascorre la maggior parte del tempo nella zona più alta dell'orbita (Apogeo). 								
			\end{itemize}
			
			{\large \bf INCLINAZIONE}	
			L'inclinazione è l'angolo tra il piano equatoriale terreste e il piano orbitale del satellite.
			\begin{itemize}
				\item Orbita polare, con inclinazione prossima ai 90 gradi, passante quindi per i poli del pianeta.
				\item Polare sincrona solare, permette di passare sopra l'equatore sempre alla stessa ora locale. Utile per sistemi di immagine satellitari.
			\end{itemize}
			
			{\large \bf CORPO CENTRALE}	
			\begin{itemize}
				\item Geocentrica, orbitante attorno alla Terra.
				\item Eliocentrica, orbitante attorno al Sole
				\item Aerocentrica, orbitante attorno a Marte.
			\end{itemize}
		
		
			{\large \bf SINCRONIA}	
			\begin{itemize}
				\item Sincrona, avente periodo orbitale uguale al periodo di rotazione del corpo centrale. Le orbite GEO fanno parte di questo gruppo (GSO)
				\item Semi Sincrona, avente periodo di rotazione pari alla metà del periodo di rotazione del corpo centrale. Ad esempio sistemi di localizzazione in MEO.
			\end{itemize}
			
						
			\subsection{Satelliti artificiali}
			Per meglio comprendere il ruolo dei satelliti artificiali nella nostro contesto, verrà riportata una breve introduzione storica e tecnica sull'argomento. Ipotesi di un satellite posto in orbita dall'uomo sono state fatte a cominciare dall'inizio del ventesimo secolo, con congetture avveniristiche che potevano essere considerate deliranti all'epoca ma del tutto quotidiane nei tempi attuali. Konstantin Tsiolkovsky (1857–1935) nel 1903 pubblicò il primo trattato accademico sull'argomento, introducendo i concetti base di un razzo multistadio e calcolò i parametri base dell'orbita geostazionaria. Nel 1928 Herman Potočnik (1892–1929) espose l'idea di una stazione spaziale che permettesse la permanenza umana in orbita, motivando contesti applicativi di ricerca e militari. Introdusse inoltre l'idea di un satellite radio in orbita geostazionaria, ma l'intuizione finale di utilizzare questa posizione privilegiata per un ponte radio e comunicazione di massa va attribuita a Arthur C. Clarke (1917–2008) nel 1945. Il primo satellite artificiale è stato lo Sputnik, lanciato nel 1957, segnando l'inizio di un irrefrenabile sviluppo tecnologico del campo che ha portato a diverse e numerose applicazioni, anche del tutto differenti dall'ambito delle telecomunicazioni. In seguito un elenco degli attuali principali utilizzi.
			\begin{itemize}
				\item {\bf Ricerca}
				
				Per la ricerca un satellite artificiale costituisce un enorme valore per la sua posizione non paragonabile ad una osservatorio terrestre. L'atmosfera ad esempio costituisce una barriera impenetrabile a molte componenti elettromagnetiche di fondamentale importanza per la comprensione dell'universo. L'esempio classico per questa categoria è il telescopio spaziale Hubble, che produce strabilianti immagini dell'universo nel infrarosso, visibile e ultravioletto. La Stazione Spaziale Internazionale è un altro esempio di ricerca, anche se definibile maggiormente come appunto una stazione spaziale, intesa come avamposto abitato, oltre che un satellite artificiale nel senso stretto del termine.
				
				\item {\bf Comunicazioni}
				
				Il primo satellite adibito a questo scopo fu {\it Echo} 1 lanciato nel 1960, consisteva semplicemente in un pallone dalla superficie elettromagneticamente riflettente, era quindi un sistema completamente passivo. Si passò a satelliti attivi fin dagli immediati successori, {\it Realy 1} e {\it Telstar 1}, entrambi lanciati nel 1962, quando il primo permise la prima diretta attraverso l'Oceano Pacifico mentre il secondo attraverso l'Atlantico. Per il primo satellite geostazionario si deve aspettare però il 1964 con {\it Syncom 3}, disattivato nel 1969, dopo circa 40 di abbandono le perturbazioni orbitali hanno traslato la sua posizione di circa 8 gradi ovest. Alcune proposte commerciali saranno menzionate più avanti.
				
				\item {\bf Meteorologia}
				
				Forniscono una continua fonte di informazioni in tempo reale di condizioni climatiche come copertura nuvolosa e temperature. Il primo satellite di questo tipo fu lanciato nel 1961, {\it Tiros 1}. Possono occupare tutti i tipi di orbita, in dipendenza dal tipo di missione. Recentemente la NASA ha posto DSCOVR, satellite di ricerca sui cambiamenti climatici, in orbita al punto lagrangiano L1, punto di equilibrio gravitazionale del sistema Terra - Sole.
				
				\item {\bf Posizionamento}
				
				La necessità di un sistema di posizionamento globale è scaturita dall'ambito militare, in generale questi sistemi sono sotto il controllo governativo ma resi disponibili liberamente con caratteristiche tecniche limitate, come ad esempio precisione minore. Il primo sistema fu dichiarato operazionale nel 1962 con il lancio di {\it Transit 5A}, e usato attivamente fino al 1996, quando fu definitivamente sostituito dal più prestante sistema GPS, oggi anche integrato in molti dispositivi di comune utilizzo come gli smarthphone. Inizialmente sviluppato solamente dagli Stati Uniti, con il passare degli anni ogni grande potenza ha portato avanti il proprio sistema di posizionamento globale. Le costellazioni degli attuali sistemi lavorano su orbite polari MEO, con un periodo di circa 12 ore e sono composte da almeno 24 satelliti più altri di riserva. 
				
				\item {\bf Militare}
				
				L'orbita offre un punto di osservazione sfruttato per operazioni di sorveglianza e raccolta informazioni. Questo settore ha avuto un grosso sviluppo durante la Guerra Fredda con la creazione di sistemi di rilevamento di lanci missilistici e raccolta fotografica del territorio nemico. Nonostante la maggior parte di queste infrastrutture non sono di dominio pubblico, questo settore ha portato grandi benefici nell'ambito civile, come la disponibilità di foto ad alta risoluzione del suolo e monitoraggio di disastri ambientali.
				
			\end{itemize}
			Un satellite per telecomunicazioni, il caso di nostro interesse, è di fatto una base ripetente che permette a una o più basi terrestri di scambiarsi informazione in varie forme. Una stazione di terra trasmette sul satellite alla frequenza di {\it UpLink}, questo riceve ed amplifica il segnale ritrasmettendolo alla frequenza di {\it DownLink} alle stazioni riceventi. Quindi i sistemi di telecomunicazione satellitare sono composti essenzialmente da un'infrastruttura terrestre e il satellite in orbita. L'infrastruttura comprende anche il centro di controllo del satellite, che si occupa di tracciamento, telemetria e controllo. Al contrario di quanto si possa pensare, il tracciamento è uno dei compiti essenziali nella gestione del satellite. Oltre ad essere necessaria per confermare la posizione corretta del satellite dopo il lancio e per permettere ad altri di puntare le proprie antenne, il tracciamento rimane una priorità costante durante tutta la vita operativa della sonda. Perturbazioni orbitali tendono a scostare il satellite dalla posizione ideale, rendendo anche necessarie periodiche accensioni dei motori di manovra per riposizionarsi correttamente. Inoltre in orbite basse (LEO) è costantemente necessario compensare l'attrito atmosferico che tende a rallentare l'oggetto e di conseguenza contribuire al suo decadimento orbitale. 
			Mediamente un satellite commerciale in orbita alta ha un tempo di vita nell'ordine di una decina d'anni, mentre per uno in orbita bassa (LEO) questo tempo si dimezza. Con la principale limitazione costituita dalla quantità di propellente a disposizione per le manovre di correzione orbitale, in orbita bassa queste sono molto più frequenti per il costante decadimento menzionato precedentemente. Una volta che il satellite è o sta per essere inservibile, il suo destino dipende dall'orbita in cui è posizionato, in orbite basse decadrà nell'arco di pochi anni distruggendosi nell'atmosfera, in orbite alte invece tenderà a rimanere nel proprio assetto per l'eternità non essendo presente nessuna forza che lo rallenti verso la superficie. Generalmente e quando possibile, il satellite viene spostato in un'orbita cimitero, in modo da non interferire con futuri lanci in quella particolare zona. 
			
			%%Elementi costituenti di un satellite
			
			Le comunicazioni satellitari hanno grande vantaggio su grandi distanze, essendo insensibili alla degradazione tipica di ponti radio ad alta frequenza a causa dell'atmosfera e alla dispersione che avviene su cavi.
			I principali {\bf vantaggi} sono sintetizzati a seguito. 
			\begin{itemize}
				\item Copertura globale, possibile cioè portare servizi di alta qualità in ogni angolo del pianeta tramite una costellazione satellitare. 
				\item Capacità, intesa come numero di comunicazioni contemporanee.
				\item Affidabilità, essendo costantemente attivo anche quando le infrastrutture terrestri collassano.
				\item Sicurezza, essendo già di per sé una rete privata, aggiungendo protocolli di sicurezza è possibile ottenere robustezza maggiore dei collegamenti terrestri.
				\item Scalabilità, perché aggiungere una nuova rete a quella esistente diventa immediato, anche in zone rurali, semplicemente allocando la banda richiesta e installando l'attrezzatura necessaria in loco.
				\item Dispiegamento rapido, al contrario di un'infrastruttura terrestre, il satellite può essere operativo in tempi relativamente rapidi.				
				\item Costi, pur essendo piuttosto elevato l'investimento iniziale della progettazione e costruzione di satelliti, questo si diluisce in un tempo lungo e permette di evitare costi ancora più proibitivi di costruzione e mantenimento di infrastrutture terrestri in ambienti ostili.				
			\end{itemize} 
		
			I principali {\bf svantaggi} invece sono costituiti dai vincoli dimensionali che impongono di conseguenza limitazioni sulla potenza di trasmissione e sui guadagni delle antenne.	Entrambi i fattori dipendono dai parametri orbitali e sull'investimento monetario. 
			\begin{itemize}
				\item Potenza. L'unica fonte di energia disponibile a bordo di un satellite sono generalmente i pannelli solari. Durante la guerra fredda era tipico avere anche satelliti ad energia nucleare con a bordo un generatore a radioisotopi, ma, oltre al costo elevato, era presente un alto rischio di contaminazione in caso di lancio fallimentare e nel rientro atmosferico a fine vita operativa.
				La bassa potenza disponibile a bordo è il principale collo di bottiglia per la potenza trasmissiva e quindi la qualità del segnale ricevuto sulla superficie. 
				\item Sensibilità in ricezione. Quest'ultima è limitata dalle dimensioni fisiche dell'apparato ricevente, che deve essere contenuto in ordine di rientrare nelle specifiche di lancio. A terra sono quindi necessarie strutture imponenti e grandi potenze per compensare questa mancanza. 
				\item Disponibilità. Fatta eccezione per i satelliti in orbita geosincrona, che rimangono il caso preferito in quanto sempre visibili da una determinata zona, il restante numero di satelliti pianifica le comunicazioni su base temporale per ogni zona d'interesse, specificando durata e qualità del contatto, essendo questi predicibili deterministicamente.
				 
			\end{itemize}
			
			
		
		\section{Architettura di rete}	
		
		La rete proposta è un complesso costituito da un gruppo eterogeneo di nodi DTN, ciascuno avente un preciso ruolo e posizione nello scambio di dati. Questa rete è un'evoluzione diretta di quella proposta in (Inserire reference al papiro). Lo scheletro è composto da una costellazione di nanosatelliti con caratteristiche descritte nel capitolo precedente, corredato da due tipologie di stazioni terrestri adibite alla comunicazione satellitare. 
		
		Lo scenario di riferimento è basato sulle seguenti tipologie di nodi, disposti secondo l'ordine di invio verso gli utenti finali:
		\begin{itemize}
			\item {\bf Central Node, CN}
			
			Questo nodo svolge la funzione di controllore della rete, gestendo le richieste e i instradando flussi di traffico. Si occupa inoltre dell'interfaccia tra la rete DTN e la rete Internet convenzionale.
			
			\item {\bf HotSpots, HS}
			
			Gli HotSpots sono le basi di comunicazione satellitare connesse al Central Node. Dispongono quindi di un collegamento radio adibito alla comunicazione con i nanosatelliti e di un collegamento cablato con il CN, quest'ultimo potrebbe essere attuato anche attraverso la rete Internet convenzionale. 
			
			\item {\bf NanoSatellites, NS}
			
			I nanosatelliti attuano la parte di trasporto vera e propria dell'informazione, assumendo il ruolo di muletto dei dati caricando e scaricando dati alle stazioni di terra.
			
			\item {\bf ColdSpots, CS}
			
			I CS sono l'analogo degli HS per le zone rurali. Sono localizzati in zone strategiche nelle prossimità degli utenti finali, e sono collegati con essi tramite una rete locale su cui non ci sono particolari vincoli. Infine è presente l'interfaccia radio per la comunicazione satellitare.
			
			\item {\bf Rural Nodes, RN}
			
			Sono i veri e propri utenti di questa rete. I nodi rurali sono un generici dispositivi a cui siamo avvezzi nella nostra quotidianità, come PC, smarthphone e tablet. Questi nodi creano le richieste e ricevono le risposte, sono quindi i nodi finali.  
						
		\end{itemize}
		
		Ora che sono stati esposti i vari costituenti della rete, è possibile esporre come una tipica comunicazione avviene in questo contesto, focalizzandosi sugli aspetti relativi alla natura DTN. 
		
		I nodi rurali sono composti da normali utenti che sono interessati ad usufruire di servizi base come la consultazione della propria posta o la navigazione di pagine web. La loro interfaccia con la rete Internet è costituita dal ColdSpot locale, ad esso le richieste vengono inoltrate e da qui in poi entra in gioco il paradigma DTN. Non esistendo una connessione diretta e stabile con la destinazione, rappresentata ad esempio da un server adibito alla pagina web richiesta, il CS trattiene la richiesta dell'utente ed elabora una risposta che emula il comportamento del server a cui l'utente rurale dovrebbe essere connesso, in modo da soddisfare i criteri di timeout tipici di una rete Internet. In questo modo il terminale dell'utente è portato a comportarsi normalmente come se fosse realmente connesso alla destinazione richiesta. Intanto il CS incapsula i dati da inviare in un Bundle DTN e calcola il miglior modo per recapitare i dati ad un HS. Dettagli riguardo a come questa scelta è elaborata saranno investigati nel prossimo capitolo. Quindi la richiesta è trattenuta fino all'opportunità di contatto con il nanosatellite prescelto. Il dato viene caricato a bordo del satellite e qui nuovamente conservato fino ad essere scaricato sul nodo HS prescelto. Ricordiamo che i nodi HS sono le stazioni radio connesse al nodo centrale tramite rete veloce. Da qui la richiesta è immediatamente inoltrata al nodo centrale, che si occupa di recuperare i dati dell'ipotetico sito come fosse un generico utente di Internet. Segue quindi l'iter standard di un nodo Internet alle prese con il recuperare una pagina web, interrogando prima il DNS, instanziando tutte le connessioni del caso, infine recuperando i dati. A questo punto è tempo di fare la strada inversa verso il nodo rurale, nuovamente, le scelte di instradamento del dato saranno oggetto del prossimo capitolo. I dati recuperati verranno mandati ad un HotSot, il quale analogamente al ColdSpot in fase di richiesta, tratterà il tutto fino a quando il NanoSatellite non entrerà in contatto. Il pacchetto DTN a questo punto sarà caricato sul NS e trasportato lungo l'orbita, qui potrà saltare per un numero indefinito di volte tra NS che entrano in contatto tra di loro, sempre seguendo una logica di instradamento ben precisa. L'ultimo salto sarà verso terra al CS in ricezione della zona rurale di partenza. Qui il CS si occuperà di instradare i dati al nodo di partenza, finalizzando la connessione.
		%%inserire grafico di comunicazione
		Da questo esempio di comunicazione bidirezionale si può dedurre che i nodi applicanti il paradigma DTN sono gli HotSpots, i Nanosatelliti e i ColdSpots. Questi spezzano le connessioni a livello di trasporto nella logica di evoluzione del TCP splitting esposta nel capitolo 2.4 e attuano la memorizzazione dei dati esposta nel capitolo 2.3. Il Central Node è un nodo capace di lavorare al livello del Bundle Protocol, gli altri nodi della rete, come ad esempio i nodi Internet che collegano gli HS al CN, ignorano il BP assimilandolo ad un livello applicativo. 
	
		
		\section{Connessioni alla Rete in aree rurali}
			
		L'accessibilità della conoscenza è diventata una delle pietre miliari del nostro tempo, uno dei simboli più marcati del progresso portato dall'evoluzione impetuosa del settore delle Comunicazioni e delle Tecnologie dell'Informazione (ICT). Questo progresso però si è affermato principalmente nelle aree più sviluppate, andando inoltre a migliorare enormemente le infrastrutture burocratiche e organizzative. Il grande freno nell'affermazione di tali tecnologie in zone più disagiate o rurali è il costo dell'infrastruttura di supporto, che richiederebbe creare da zero una rete in zone dalle condizioni naturali estremamente avverse o dalla situazione politica incerta e disinteressata. Inoltre la scarsa densità abitativa di tali aree non potrebbe giustificare a maggior ragione il dispiegamento di una rete ad alta capacità. Esclusi luoghi dalle condizioni naturali estreme, come latitudini polari o atolli oceanici, le restanti zone rurali potrebbero essere caratterizzate inoltre da problemi di emergenza umanitaria ben più gravi della mancanza dell'infrastruttura ICT, ma se posta in questi termini il divario con la civiltà urbana occidentalizzata non potrebbe che aumentare. Nel prossimo capitolo saranno esposti alcuni approcci sviluppati per creare un'alternativa alla rete convenzionale che noi conosciamo nella nostra quotidianità.
			
				\subsection{Motivazione dell'approccio nanosatellitare}			
					
				Questa ricerca punta alla creazione di una rete globale e indipendente, i cui principali vantaggi sono in primo luogo il basso costo, sempre in paragone con le alternative esistenti che propongono servizi comparabili esposti precedentemente, la scalabilità, essendo che è possibile un dispiegamento graduale delle risorse, aggiungendo man mano che i fondi diventano disponibili nuovi nanosatelliti, HotSpots e zone rurali. Da questo punto si ottiene un'importante altra conseguenza, la robustezza della rete. La perdita di uno o più nodi non costituisce una criticità per il funzionamento complessivo. 
					
				Altri vantaggi nell'usare una rete satellitare derivano dalla totale indipendenza dalle condizioni e vicissitudini superficiali, quindi la rete è immune a disastri naturali e difficilmente soggetta a sabotaggi e censure politiche.
					
			\subsection{Altri approcci al problema}
			
			\begin{itemize}
				\item {\bf Digital Gangetic Plains \cite{raman2007experiences}}
				
				Questo progetto consiste nel coprire una vasta area di territorio con una rete WiFi 802.11. I vantaggi di questa tecnologia è che non ha costi proibitivi, occupa una porzione libera nello spettro di frequenze e offre alte velocità di connessione. La rete è composta da una serie di ripetitori WiFi atti a creare una rete {\it mesh}, cioè una rete connessa a grafo. Il nodo principale ha accesso alla rete Internet cablata e rappresenta il punto d'accesso. I ponti radio possono essere distanti decine di kilometri e sono collegati da antenne direzionali ad alto guadagno. 
				
				\item {\bf DakNet \cite{hasson2003daknet}}
				
				Questa soluzione coinvolge l'utilizzo di infrastrutture esistenti per il trasporto fisico dei dati, nello specifico mezzi pubblici come autobus. Il veicolo diventa la spola, similmente al nanosatellite del nostro caso, tra la zona rurale e il punto di accesso a Internet. Muovendosi lungo il suo percorso programmato, il mezzo prende in carico le richieste da parte degli utenti sparsi per i villaggi e una volta arrivato in contatto con il punto di accesso recupera tutti i dati per consegnarli al prossimo giro. Il cuore pulsante a bordo del bus è un PC Linux embedded e comunicazione WiFi. 
				
				\item {\bf KioskNet \cite{seth2006low}}
				
				Il termine {\it kiosk} è traducibile come "chiosco" ma prende l'accezione specifica di una sorta di internet caffè, utilizzabile a pagamento per l'accesso a Internet pubblico. Questo genere di attività è fiorente in zone rurali, ma soffre di problemi legati all'infrastruttura fatiscente che lo supporta, cominciando dall'energia elettrica per finire alla connessione telematica. Lo scopo quindi è stato di semplificare la tecnologia supportante questo servizio per contenere costi e manutenzione, cominciando con l'usare PC embedded a basso consumo per potersi rendere indipendenti con l'utilizzo di pannelli solari, continuando poi adottando un paradigma DTN con idea simile al DakNet in quanto a riutilizzo dei sistemi di trasporto esistenti.
								
			\end{itemize}
			
			Il limite primo di tutte queste proposte è l'affrontare il problema con un approccio locale, sempre a rischio di fattori ambientali e politici instabili. L'alternativa proposta da questo lavoro di ricerca è chiamata "Ring Road" \cite{burleigh2011toward} e non è altro che l'infrastruttura esposta ad inizio capitolo.
		
		\subsection{Alternative commerciali}
		Mentenere una copertura Internet globale non è semplice:
		\begin{itemize}
			\item Con una costellazione in GEO è possibile mantenere una connessione persistente con un puntamento fisso, inoltre la costellazione può essere composta da un numero minore di satelliti rispetto a quelli necessari in orbita LEO, con l'altitudine maggiore come motivazione diretta di questo fatto.
			D'altra parte altezze più elevate comportano costi di lancio e piattaforma satellitare maggiori, infatti un satellite in questa orbita generalmente richiede un investimento intorno ai 300 milioni di dollari. Infine le zone polari non sono coperte per la posizione equatoriale dell'orbita GEO e le latenze sono alte a causa delle grandi distanze in gioco.
			
			\item Le costellazioni LEO sono in grado di mantenere una copertura globale sostituendosi a vicenda nella copertura durante il loro costante movimento, rendendo necessarie però antenne a puntamento automatico per ottenere velocità di trasferimento comparabili a quelle dei satelliti in GEO. Immaginando l'antenna del satellite puntata in direzione del suolo, ci si rende conto come la massima qualità di ricezione, ottenibile quando le due antenne, suolo e satellite, sono allineate, possa durare al massimo qualche istante. Lo svantaggio della minor banda viene compensato da una latenza decisamente minore. L'investimento si abbassa anch'esso, ma rimane comunque alto intorno ai 150 - 200 milioni di dollari, tenendo a mente che sono necessari più satelliti.
		\end{itemize}
		
		
		%%Calcolo che non comprendo appieno onestamente
		Per confronto, vengono riportati alcuni esempi di tariffe commerciali (2009):
		\begin{itemize}
			\item {\it ORBCOMM}, servizio tipicamente utilizzato per brevi messaggi, propone 1000 caratteri a 1.40\$, tradotto in nostri termini 1433.60\$ per MB.
			\item {\it Iridium} offre diversi piani con un costo variabile a seconda delle proprie esigenze, solo per termine di confronto, si riporta il piano Combo A, 69\$ mensili per 13.8\$ per MB, e il Combo F, 1499\$ al mese e 1.10\$ per MB.
			\item {\it INMARSAT}, che usa una costellazione di tre satelliti in GEO, offre una tariffa al MB di 7.50\$
		\end{itemize}
		%%Verificare un secondo questi dati
		Occorre far notare che questi servizi sono usufruibili tramite un modulo di collegamento personale, delle dimensioni paragonabile a quelle di un portatile non troppo recente. Ogni compagnia menzionata usa una propria tecnologia non compatibile con le altre. I dettagli implementativi del livello radio e hardware della nostra soluzione non sono ancora stati definiti e non è neanche compito di questo gruppo di studio definirli, ma allo stato attuale la direzione implementativa non è quella di un oggetto personale che ha il compito di interfacciare il proprio PC, ad esempio, con la rete nanosatellitare, ma piuttosto una base condivisa a una zona, idealizzabile come una comunità o un villaggio, dove l'utenza si reca per usufruire del servizio. Questa scelta si pone in relazione con il tipo di contesto e utenza per cui questa rete è sviluppata. 
		
		Altro importante punto da sottolineare è il tipo di esperienza d'uso che consegue da una rete DTN, sostanzialmente diversa da quella a cui siamo comunemente abituati con la rete Internet. Il concetto di una rete tollerante alle disconnessioni e ritardi, non avente un percorso continuo tra sorgente e destinazione, ad esempio nella navigazione Internet ha l'effetto che tra la richiesta di una pagina e un'altra possono passare minuti, anche qualche decina. 
		
		Tutto questo si pone in linea con le alternatine di rete rurale proposte, mentre è incomparabile con i servizi commerciali menzionati, i quali offrono un'esperienza d'uso comparabile ad una rete convenzionale a velocità limitata. Nel contesto in cui la nostra soluzione si pone i limiti menzionati possono essere accettabili, essendo che lo scopo non è rendere disponibile una rete Internet paragonabile a quella convenzionale in ogni angolo del pianeta, ma piuttosto rendere disponibile Internet a zone e comunità che altrimenti non avrebbero possibilità di accedervi.
		
		Riassumendo quindi l'uso di nanosatelliti permetterebbe di evitare tutti gli svantaggi di una rete terrestre pur essendo più economica di una rete satellitare GEO o LEO. 
		
		\subsection{La nostra costellazione}
		La costellazione di satelliti scelta per questo lavoro è in orbita LEO, che a confronto con un'orbita GEO offre il vantaggio di investimenti iniziali e latenze minori, ma ha il principale svantaggio che i satelliti sono in costante movimento rispetto alla superficie e quindi l'apparato di terra deve essere in grado di orientare l'antenna per rimanere agganciato al segnale. Come detto in precedenza, questa configurazione non permette, in termini di qualità del segnale, prestazioni ottimali in generale o comunque per tutta la durata del contatto. Inoltre un singolo satellite in orbita GEO costituisce un punto di criticità in caso di malfunzionamento rispetto ad una costellazione sparsa in orbita LEO. Questi compromessi però sono tutti a vantaggio del requisito principale di questo lavoro, ridurre i costi d'investimento per la creazione di una rete DTN in grado di estendere la copertura Internet a zone rurali. Una costellazione in orbita GEO rimane preferita in ambito di telecomunicazioni, ma comporta costi estremamente elevati. Sempre in quest'ottica è stata fatta la scelta del tipo di satellite, il nanosatellite.
		
		I nanosatelliti sono una realtà piuttosto recente, spesso utilizzati come piattaforme di test per nuove tecnologie o come piattaforma orbitale congiunta di università per esperimenti o dimostrazioni. Le loro peculiarità sono le dimensioni estremamente ridotte e standardizzate, nell'ordine delle decine di centimetri per lato, e il basso costo di progettazione, produzione e mantenimento. Eliminando completamente caratteristiche come un propulsore, pannelli solari orientabili, antenne ad alto guadagno, sistemi ridondanti, ecc... si possono ridurre notevolmente dimensioni e costi. In particolare i costi di messa in orbita sono notevolmente abbattuti in quanto possono essere aggregati ad altri lanci come carichi secondari. Infine alcuni sono lanciati insieme al rifornimento periodico alla Stazione Spaziale Internazionale (ISS) e da essa catapultati in orbita tramite un apposito lanciatore. 
		Una soluzione pratica è costituita dai CubeSat, un tipo standardizzato di nanosatellite, in termini di volume e peso. Nello specifico, l'unità base del CubeSat è un parallelepipedo 10x10x11.35 cm, con un peso massimo di 1.33Kg, pensata per mettere a disposizione un litro di volume all'interno. Le unità base possono essere combinate per ottenere CubeSat più capienti. La standardizzazione, come per altro in ogni ambito ingegneristico, permette di abbattere ulteriormente i costi di lancio, non essendo necessario sviluppare una piattaforma nuova per ogni nanosatellite e semplificare le interazioni tra i gruppi che si occupano del lancio e della costruzione del nanosatellite.
		
		Il principale vantaggio nell'uso dei nanosatelliti è il costo di investimento decisamente abbattuto. Il costo di assembleaggio stimato si aggira intorno ai 50000\$ - 100000\$, mentre il costo di lancio stimato di tre CubeSat è all'incirca di 200000\$. Il costo totale, approssimativo, di una rete composta da 150 nanosatelliti e 3000 stazioni di terra si può stimare essere all'incirca di 33 milioni di dollari e con un'aspettativa operativa di 5 anni. A 24 Mbps il volume totale scambiato sarebbe di 225 TB, per un costo al MB di 0.13\$. Se questa cifra viene confrontata con quelle riportate nella sezione precedente ci percepisce una netta differenza, pur mettendo in conto le considerazioni dovute. 
		
		I parametri orbitali si rifanno alla costellazione Iridium \cite{fossa1998overview}, con i nanosatelliti distribuiti su piani orbitali inclinati di $86.4\,^{\circ}$. Il numero di orbite differenti è un parametro di simulazione su cui è possibile agire, le orbite vengono spaziate differenziando l'angolo RAAN, Right Ascension of the Ascending Node, in altre parole i piani orbitali sono ruotati, mantenendo la stessa inclinazione rispetto all'equatore, rispetto all'asse terrestre. I nanosatelliti sono distribuiti nelle orbite in numero uniforme, come anche è uniforme la loro disposizione sull'orbita. 
		
		Infine ripetiamo che il funzionamento a livello di rete è garantito dal Bundle Layer introdotto dall'architettura DTN, che permette la gestione della memorizzazione a lungo termine durante le lunghe disconnessioni. I Bundle Protocol Data Unit sono gestiti e instradati ad ogni nodo DTN intermedio. Senza discostarsi troppo dall'architettura DTN canonica, è necessario definirne una versione personalizzata progettata per la nostra particolare applicazione. I dettagli sono rimandati alla prossima sezione. 
		
			
		
		
	\chapter{Source Contact Graph Routing}
	
		\section{Introduzione}
		Per instradamento, in inglese {\it routing}, si intende il percorso con cui i dati vengono trasferiti tra sorgente e destinazione. Relativamente a questo lavoro la questione è stata rimandata ad un capitolo separato perché rappresenta il punto centrale della tesi, posta nel contesto di ricerca più ampio introdotto in precedenza. 
		
		Verranno in seguito esposte le nozioni necessarie per comprendere il concetto Source Contact Graph Routing (SCGR), traducibile come instradamento a sorgente su grafo di contatti. SCGR è un'estensione del concetto di CGR proposto da Burleigh et al. \cite{burleigh2010contact}, che trae vantaggio dal fatto che le missioni spaziali sono minuziosamente pianificate e quindi i vari nodi possono essere a conoscenza di un futuro stato della rete. Non si rende necessario un dialogo tra nodi prima di confermare il prossimo salto, ma piuttosto la conoscenza dello stato della rete permette di creare un grafo di contatti, inteso come un modello variante nel tempo di connettività tra nodi, sul quale è possibile applicare l'algoritmo euristico proposto per trovare il miglior percorso. Con algoritmo euristico si intende essere capace di trovare una soluzione prossima all'ottimale, un compromesso necessario per limitare i tempi di calcolo necessari per una soluzione ottima. Sviluppata dalla NASA, questa idea permette maggiore flessibilità e resilienza della rete spaziale, permettendo di semplificare e ridurre i costi di gestione della missione.
		
		L'iniziale soluzione applicata alla rete DTN nanosatellitare per l'instradamento seguiva la logica CGR, dove ogni nodo conteneva le informazioni di contatto della rete e decideva ogni hop successivo durante le opportunità di contatto. L'alternativa proposta da questo lavoro invece sposta la decisione dell'intero percorso del bundle nel momento in cui questo viene generato. Il principale vantaggio consiste che all'origine si può ancora avere una visione d'insieme completa, non essendo condizionati nelle scelte di instradamento precedenti. Da qui l'aggiunta di "Source" a CGR, essendo un instradamento deciso a livello di sorgente. 
		
		\section{Predizione dei contatti e Contact Table}
		%Spiegazione contact table e la sua logica di compilazione
		Predire la posizione di un corpo in orbita è molto complesso a causa delle perturbazioni orbitali. Tra queste ricordiamo la non-sfericità terrestre, attrito atmosferico, campo gravitazionale irregolare, vento solare, l'attrazione di altri corpi celesti come Luna e Sole, una non perfetta modellazione della spinta del motore \cite{gilmore2009predicting}. Esistono diversi algoritmi, di diversa complessità, come ad esempio SPG4 proposto in \cite{gilmore2009predicting} che permette un'accuratezza di circa 1km, tenendo a mente che la soluzione diverge più si spinge la predizione nel futuro. Bisogna però considerare come queste informazioni vengono usate, nell'interesse di questa ricerca infatti non è necessario soffermarsi sulla precisione assoluta della posizione del satellite, ma piuttosto è di importanza il movimento in relazione al resto della costellazione. Certo, in un contesto applicativo pratico ci sarebbe bisogno di migliorare la precisione di queste informazioni, ma in questo caso verrebbero anche usate tecniche aggiuntive, come ad esempio il tracciamento da una stazione di terra, per migliorare i risultati delle simulazioni. Nel contesto di simulare una rete reale e di avere quindi la necessità di conoscere un generico comportamento della costellazione dal punto di vista dei contatti possibili tra nanosatelliti in orbita e tra nanosatelliti e stazioni di terra, sono state ignorate le perturbazioni orbitali sopramenzionate e si è scelto di fare riferimento ad un modello semplicistico della costellazione con orbite circolari. 
		
		In seguito a queste decisioni è stato sviluppato un algoritmo in modo indipendente che potesse svolgere questo compito. Prima di esporlo è necessario definire il concetto di contatto e quantificare le sue dimensioni. Importante tenere a mente che contatti multipli, vale a dire tra più di due nodi contemporaneamente, non sono ammessi e ignorati. Questa limitazione è direttamente dipendente dalla piattaforma di simulazione, non rappresenta un vincolo progettuale ma anzi fa parte degli sviluppi futuri trattati nell'ultimo capitolo.
		\begin{itemize}
			\item Contatto tra nanosatellite e stazione di terra, soglia massima 600 km
			\item Contatto tra nanosatellite e nanosatellite, soglia massima 500 km			
		\end{itemize}
		Essendo che nella durata di una simulazione possono verificarsi centinaia di contatti, anche coinvolgendo gli stessi nodi, è necessario che per ogni contatto sia riportato il tempo di inizio e il tempo di fine per poterlo distinguere univocamente. 

		Senza entrare nei dettagli implementativi, il funzionamento base dell'algoritmo è basato su una discretizzazione del tempo. L'inizializzazione dell'algoritmo distribuisce i satelliti sulle diverse orbite, come spiegato nel capitolo descrittivo della nostra costellazione, e fissa le stazioni di terra, HotSpot e ColdSpot, sulla superficie terrestre, secondo le coordinate di questi fornite come input. Ogni 10ms, un campionamento del tempo di simulazione deciso empiricamente, giudicato sufficientemente accurato, le posizioni di tutti i nodi vengono aggiornate avanzando lungo il loro moto naturale. Ad ogni passo infine è calcolata la distanza Euclidea tra ogni nodo e verificata se inferiore alla soglia necessaria. I risultati vengono quindi raccolti e salvati costruendo un file chiamato Contact Table.
		
		%Esempio di contact table e spiagazione dei vari campi
		
		
		

		\section{Concetti di una rete deterministica} \label{concDet}

		%%vantaggi di una rete deterministica in termini di gestione e ottimizzazione
		La Contact Table rappresenta la conseguenza diretta di una rete deterministica come la nostra, dove per ogni istante del tempo di simulazione è definita la topologia della rete e sulla quale possono essere fatte scelte decisionali a priori. Questa peculiarità permette di poter avere una visione di insieme dello stato e di tenere traccia delle conseguenze delle scelte fatte in tempo reale. In altre parole è possibile aggiornare la conoscenza futura dello stato della rete in funzione delle decisioni prese allo stato attuale. Un esempio pratico di questo concetto è stato introdotto dal presente lavoro di Tesi, offrendo interessanti possibilità di sviluppo oltre all'utilizzo implementato in questa sede. 
		Immaginando i contatti come punti noti nel tempo e si pensi di allegare a questi una serie di informazioni riguardanti i nodi coinvolti. Un esempio di informazione in particolare, unica implementata e testata al momento, è la quantità di dati trasferibile tra i due nodi nel contatto. Questo dato è di fondamentale importanza nella pianificazione dell'instradamento perché costituisce un limite fisico della rete, non tenere conto di questa limitazione porterebbe inevitabilmente ad un conflitto tra quanto pianificato e quanto realmente succede. 
		Prendiamo come esempio la necessità di trasferire un pacchetto dal nodo A al nodo B. Questi estremi sono dati come input all'algoritmo di instradamento, esposto nel prossimo sotto paragrafo, che restituisce un elenco ordinato di contatti da sfruttare. Se questo percorso viene confermato, allora sappiamo, ancora prima che il pacchetto effettivamente parta, che la banda disponibile dei contatti coinvolti nel trasferimento sarà usufruita dal pacchetto in questione. Risulta quindi necessario sottrarre la dimensione del pacchetto dalla quantità di dati trasferibile per ogni contatto coinvolto. In questo modo, se un contatto risulta particolarmente gettonato, non sarà possibile eccedere la sua capacità di trasferimento {\bf a priori}, cioè prima ancora che questo avvenga. 
		
		I vantaggi di questo genere di pianificazione stanno nella possibilità di prevedere ed evitare congestioni direttamente alla sorgente, evitando il verificarsi del problema piuttosto che affrontarlo {\bf a posteriori}. Non si rendono più necessari inoltre scambi di informazioni tra nodi per decidere sul momento che azione intraprendere, come anche non risulta necessario aggiornarli sulla topologia della rete, riducendo allo stesso tempo {\it overhead} di servizio, consumo di energia e complessità dei nodi DTN. Il nodo DTN deve quindi solamente seguire le istruzioni fornitegli, agendo senza prendere decisioni ulteriori.
		
		Avvicinandosi all'implementazione pratica, rimane da chiarire come l'informazione di instradamento venga passata ai nodi coinvolti. La soluzione scelta va a modificare l'{\it header} DTN, aggiungendo alla fine un campo \emph{N Hops}, che indica il numero di salti necessari per raggiungere la destinazione, e infine seguono, in senso di percorrenza, le due informazioni necessarie per identificare un contatto, indirizzo del nodo e tempo di inizio. Queste due ultime informazioni sono ripetute tante volte quanto è indicato nel campo \emph{N Hops}, si ha quindi a che fare con un {\it header} a lunghezza variabile.
		
		\vspace{25pt}
		\begin{bytefield}[bitwidth=0.5em]{64}
			\bitheader{0, 8, 16, 24, 32, 40, 48, 56, 64} \\
			\bitbox{8}{N Hops} \\
			
			\begin{rightwordgroup}{Paths \\ hops}
				\bitbox{32}{Contact Start 1} & \bitbox{32}{Next Hop EID 1} \\
				\bitbox{32}{Contact Start 2} & \bitbox{32}{Next Hop EID 2} \\
				\wordbox[]{1}{$\vdots$} \\[1ex]
				\bitbox{32}{Contact Start $N$} & \bitbox{32}{Next Hop EID $N$}
			\end{rightwordgroup}
			
		\end{bytefield}
		\vspace{25pt}
		
		Altra importante precisazione riguarda quali nodi della nostra rete DTN sono addetti alla creazione dei Bundle DTN e di conseguenza al calcolo a sorgente del loro instradamento. \`E necessario distinguere due flussi di traffico, dagli utenti rurali al Nodo Centrale e dal Nodo Centrale verso gli utenti rurali. Il Nodo Centrale ricordiamo essere l'interfaccia di tutta la rete DTN con la rete Internet, risulta quindi obbligatorio che sia la sorgente per tutti i Bundle diretti verso gli utenti rurali. Diversa invece la situazione per il traffico in direzione inversa, dove è il ColdSpot l'interfaccia tra l'utente rurale e Internet, e sono quindi quest'ultimi a generare i Bundle diretti verso il nodo centrale. Per essere più formali bisogna precisare quindi che la rete DTN è confinata dal Nodo Centrale da un lato, connesso poi a Internet, e dai ColdSpot dall'altro, questi connessi ai nodi rurali. Nodo Centrale e ColdSpot definisco i bordi della rete e sono gli unici nodi a poter creare e decidere l'instradamento dei Bundle DTN, ma questa affermazione suscita un'incongruenza sulla quale non è ancora stata fatta chiarezza. Essendo questi due nodi separati non risulta possibile mantenere aggiornati i dati relativi all'uso dei contatti, cioè l'aggiornamento conseguente alla creazione di un bundle DTN al Nodo Centrale, ad esempio, non può essere riportata in tempi brevi e senza spreco di risorse sui database di tutti i ColdSpot della DTN. La soluzione proposta, ma non investigata, parte con un'analisi dei due differenti flussi di traffico. Il traffico generato dai ColdSpot è, generalmente, paragonabile con il traffico in {\it upload} di un normale utente Internet, cioè una moltitudine di piccole richieste verso i server {\it host} di pagine web o email. Questa ipotesi implica trascurare utenze che ad esempio caricano grossi file, tipo video o immagini, e quindi considerare preponderante il traffico nella direzione opposta, cioè, dal punto di vista degli utenti, in {\it download}, che contiene le pagine web stesse piuttosto che altri tipi di dati. La conclusione di questo ragionamento è giustificare la decisione pratica di mantenere i dati aggiornati sui contatti solamente al Nodo Centrale, proprio perché questo nodo si prende carico di {\bf tutto} il traffico diretto da Internet verso i nodi rurali e quindi si ipotizza che questo flusso sia notevolmente più soggetto a porre stress sulla rete. I ColdSpot sono comunque a conoscenza dell'evolversi futura della topologia di rete, possono quindi effettuare le loro scelte di routing ma conoscerne le conseguenze. Sempre motivata dalle considerazioni precedenti, la soluzione, che ricordiamo non è investigata in questo lavoro, potrebbe consistere nel lasciare un margine libero nei contatti da parte del Nodo Centrale per mettere in conto il traffico inverso, ipotizzato piccolo ma non trascurabile. 
		
		% Diagramma con i due flussi che mostra i nodi coinvolti 
		

		\section{Algoritmo di instradamento}
		
		Come ultimo tassello per completare il percorso logico è necessario introdurre il procedimento computazionale per calcolare il percorso alla sorgente. Innanzitutto è necessario esporre gli ingressi e le uscite dell'algoritmo, comprese le strutture dati e le funzioni di supporto. I dati su cui si basa l'instradamento sono contenuti nella Contact Table, quest'ultima però riordinata dal punto di vista del singolo nodo, quindi per ogni nodo si ha l'intera pletora di contatti previsti ordinati cronologicamente. L'unità base di tutta la struttura dati è il {\bf Contatto}, che contiene tutte le informazioni che lo riguardano. La serie di salti che dovrà compiere il bundle invece è contenuta in una struttura di tipo {\bf Percorso}, che è costituita da una serie di {\bf Contatti} ordinati cronologicamente. 
		
		I dati necessari da fornire in ingresso all'algoritmo sono i seguenti:
		\begin{itemize}
			\item {\bf Contact Table}
			\item {\bf Indirizzo di destinazione}
			\item {\bf TOV} Time Of Validity, indica il limite temporale entro il quale il bundle deve arrivare a destinazione. Oltre questo limite i dati perdono significato e possono essere scartati. Inoltre questo parametro ottempera le linee guida di design esposte nella sezione 2.3. Infine in termini pratici è particolarmente utile per evitare la degenerazione della ricerca in percorsi con tempo di arrivo troppo inoltrati nel futuro. 
			\item {\bf SOB}	Size Of Bundle, indica la dimensione del bundle in byte ed è necessario per verificare che questa non ecceda la capacità di trasferimento rimanente del contatto e altri controlli dello stesso tipo. 
		\end{itemize}
		
		Il dato che ci si aspetta in uscita è invece una struttura di tipo {\bf Percorso}, contenente tutti i contatti che dovrà sfruttare il bundle per arrivare a destinazione. Per ottenere questo risultato il flusso di elaborazione deve passare per diverse routine differenti, ma in questa sede verrà approfondita in forma sintetica solamente la procedura centrale e di reale interesse. Le routine di contorno infatti sono fortemente dipendenti dall'implementazione e svolgono un ruolo di inizializzazione e finalizzazione delle strutture dati prima e dopo queste sono state elaborate dall'algoritmo centrale.
		
		Entrando nel dettaglio, l'algoritmo in questione può considerarsi un derivato della forma ricorsiva di una tipologia denominata {\bf DFS}, utilizzata per la ricerca nelle struttura ad albero o a grafo. {\bf DFS} è l'acronimo di {\it Depth-First Search}, cioè ricerca con priorità della profondità. Le strutture ad albero sono costituite da una serie di nodi che si diramano da un nodo radice verso i nodi foglia, i più esterni. Una ricerca DFS parte dalla prima diramazione del nodo radice prendendo poi tutte le prime diramazioni e arrivando ad un nodo foglia. A questo punto è quindi necessario arretrare di un nodo, dal nodo foglia al nodo precedente, e si passa a prendere la seconda diramazione. Iterativamente, una volta finite le diramazioni foglia, si passa alla seconda diramazione di due nodi predenti, e così via. La natura di questo procedimento è intrinsecamente ricorsiva, infatti si può immaginare che appena si sceglie un ramo e ci si sposti al prossimo nodo ci si ritrovi esattamente nella situazione precedente, al nodo radice di un sotto albero. Ricorsiva infatti è l'implementazione qui riportata. Questo tipo di ricerca si contrappone alla ricerca in ampiezza BFS, {\it Breadth-First Search}, che non passa al livello successivo finché tutti i nodi dello stesso livello non sono stati esaminati, quindi nel procedere nell'esplorazione del grafo non indietreggia mai al nodo precedente. 
		% Inserire esempio di albero
		
		Questo piccolo approfondimento è utile per capire come è possibile ricondurre il nostro problema alla ricerca in una struttura ad albero, i nodi di quest'ultimo infatti possono essere considerati i nodi della nostra rete e la loro disposizione relativa determinata dai contatti. Considerando il flusso di traffico diretto dal Nodo Centrale ai nodi rurali, immaginiamo di porre come nodo radice il ColdSpot della zona rurale di destinazione. Sarebbe inutile porre in questa ricerca il nodo rurale di destinazione perché qualunque tipo di comunicazione sarebbe comunque vincolata per il ColdSpot. A questo punto la prima schiera di rami è costituita dai contatti del ColdSpot e iterativamente si può costruire l'intera struttura di nodi, ogni volta considerando i contatti del nodo per creare il livello successivo. I nodi foglia invece sono gli HotSpot, dove il processo iterativo si ferma, avendo creato con successo un possibile percorso tra HotSpot e ColdSpot, e di conseguenza un percorso tra il Nodo Centrale e l'utente rurale. Viene da sé pensare che i nodi intermedi siano costituiti da nanosatelliti e ColdSpot, il che sarebbe assolutamente plausibile, ma si è scelto di limitare i salti intermedi ai soli nanosatelliti perché i contatti con i ColdSpot costituiscono un collo di bottiglia per la rete essendo un passaggio obbligato, in questo modo si evita di sovraccaricarli ulteriormente con trasferimenti che non li contemplano come destinazione. Una regola fondamentale da riportare nella costruzione dell'albero è la coerenza temporale nel considerare i contatti. In primo luogo sarebbe inutile prendere in considerazione contatti già terminati. Ricordando che non è ammesso avere contatti multipli, che altrimenti darebbero  la possibilità a ponti radio a cui ricordiamo non essere interessati volendo indagare il comportamento di una rete DTN, esiste la possibilità di sfruttare contatti in corso di svolgimento solo a livello di nodo foglia, o HotSpot, che ricordiamo essere il nostro punto di partenza. Considerare di sfruttare un contatto in corso di svolgimento tra due nanosatelliti, ad esempio, sottintende la necessità di far arrivare i dati ad uno dei due in tempo reale, quindi necessariamente si sottintende un contatto multiplo per potere ricevere i dati. Partendo dalla radice, che ricordiamo essere la nostra destinazione in realtà, non sarebbe utile considerare contatti con tempo di fine oltre il {\bf TOV}. Notare che come senza il secondo limite la struttura potrebbe diventare potenzialmente infinita. Per quanto riguarda i nodi figli invece non è possibile considerare contatti con tempo di fine maggiore del tempo di inizio del contatto che li ha generati dal nodo padre, in altre parole, non è possibile tenere in considerazione contatti che avvengono successivamente al contatto selezionato per il prossimo salto, essendo ormai troppo tardi per passare i dati al nodo successivo. Il percorso quindi viene generato partendo dalla destinazione, al contrario se vogliamo, e ponderando tutte le diverse possibilità per arrivare ad un HotSpot.
		
		Nella necessità di creare un percorso per il flusso di traffico inverso, da nodo rurale a Nodo Centrale, tutte le regole viste in precedenza vanno ribaltate, essendo opposto il punto di vista. Una differenza simmetrica in realtà esiste, essendo che HotSpot e ColdSpot non sono due tipologie speculari, i primi sono indifferenziati, paritari. I secondi invece sono ben distinti e non intercambiabili, quindi la ricerca del percorso seguirà sì le stesse regole, ma con una logica di insieme diversa. Il nodo radice può essere un generico HotSpot, si hanno allora tanti nodi radice, e quindi tanti alberi distinti, quanti sono gli HotSpot. I nodi foglia invece possono essere solo il ColdSpot relativo alla zona rurale dove il dato viene generato. Questa è una soluzione che non è stata indagata in questo lavoro, ma riportata comunque per completezza e come aggancio a sviluppi futuri. 
		
		Importante distinguere la struttura ad albero da una struttura a grafo, dove in quest'ultima i nodi sono interconnessi tra di loro senza regole precise e anche con connessioni multiple, visto che è possibile che due nodi entrino in contatto più di una volta. Non siamo interessati ad una struttura di questo tipo perché renderebbe estremamente difficile tenere traccia della disposizione temporale dei contatti, premessa fondamentale per costruire un percorso ordinato temporalmente. La struttura ad albero proposta invece assicura una contiguità temporale grazie alle regole di costruzione introdotte. Interessante notare anche come un algoritmo BFS non farebbe al caso nostro, perché non crea una connessione tra nodo radice e nodo foglia, scopo di tutto il procedimento.
		
		
		
			\begin{algorithm}
				\SetStartEndCondition{ (}{)}{)}\SetAlgoBlockMarkers{}{\}}
				\SetKwProg{Fn}{}{\{}{}\SetKwFunction{FRecurs}{void FnRecursive}
				\SetKwFor{For}{for}{\{}{}
				\SetKwIF{If}{ElseIf}{Else}{if}{\{}{else if}{else\{}{}
				\SetKwFor{While}{while}{\{}{}
				\SetKwRepeat{Repeat}{repeat\{}{until}
				\AlgoDisplayBlockMarkers\SetAlgoNoLine
				\newcommand{\forcond}{$i=0$ \KwTo $n$}
				\SetKwFunction{FRecurs}{SCGR}
				
				\SetKwInput{sob}{SOB}
				\SetKwInput{tov}{TOV}
				\SetKwInput{percorso}{Percorso}
				\SetKwInput{contatto}{Contatto}
				\SetKwInput{percorsi}{TuttiPercorsi}
				
				\sob{Size Of Bundle, la dimensione in byte del Bundle.}
				\tov{Time Of Validity, tempo massimo di consegna del Bundle a destinazione. Oltre questo limite i dati perdono significato.}
				\percorso{Struttura dati che contiene una serie di contatti.}
				\contatto{Contiene il tempo di inizio e l'indirizzo del nodo con cui si è in contatto.}
				%\indirizzo{}
				\percorsi{Contiene tutti i percorsi validi trovati.}
				
				\Fn{\FRecurs{{\bf Indirizzo} destinazione, {\bf Percorso} finoAQui, {\bf TOV}}}{
					
					\For{Per ogni contatto di questo nodo, da adesso fino al {\bf TOV}}
					{
						{\bf NuovoPercorso} = finoAQui;
						
						\If{Se il contatto è compatibile con le specifiche}
						{
							{\bf NuovoPercorso}.aggiungi({\it Questo conttato});
							
							\If{Se il nodo in contatto è un HotSpot}
							{
								{\bf TuttiPercorsi}.aggiungi({\bf NuovoPercorso});
							}
							\ElseIf{Se il nodo in contatto è un nanosatellite}
							{
								SCGR({\bf Indirizzo} del nodo in contatto, {\bf NuovoPercorso}, istante inizio contatto);
							}
						}
					}
				}
			
			\end{algorithm}
		
		Volendo adesso discutere il flusso dell'algoritmo, si faccia riferimento a quello qui riportato, valido per la ricerca di percorsi dal Nodo Centrale alle zone rurali. All'inizio un breve sunto delle strutture dati introdotte a inizio capitolo. 
		
		Alla prima iterazione il parametro destinazione contiene l'indirizzo del ColdSpot, mentre il {\bf Percorso} {\it finoAQui} è vuoto, essendo appena partiti. Quest'ultima struttura tiene traccia del percorso fatto durante le varie iterazioni, agendo come una sorta di {\bf stack}, permettendo di aggiungere e rimuovere solo dal fondo i contatti ({\it riga 1}). 
		
		Il corpo è di fatto un {\bf for} ({\it riga 2}) che ad ogni ciclo prende in esame un contatto diverso del nodo indicato come destinazione, in ordine temporale. I limiti sono quelli esposti in precedenza: contatti da questo istante fino al {\bf TOV}. Quindi una nuova struttura viene inizializzata({\it riga 3}), {\bf NuovoPercorso}, usata per tenere traccia del contatto aggiunto in questo ciclo del {\bf for}. Il suo contenuto sarà il percorso fatto fino ad adesso con in fondo uno dei contatti del nodo a cui ci riferiamo come destinazione in questa chiamata della funzione. Come detto nel paragrafo precedente queste strutture di {\bf Percorso} sono gestite come degli {\it stack}, dove se un contatto viene aggiunto in fondo durante il resto del ciclo, viene poi rimosso nuovamente in questa riga di codice nel ciclo successivo, preparando la struttura a considerare il prossimo contatto nella schiera spazzata dal {\bf for}. Tutto questo però se il contatto preso in esame viene considerato valido dalla verifica {\bf if} successiva ({\it riga 4}), che rappresenta un bivio decisionale cruciale per il risultato dell'elaborazione. Questa verifica considera la compatibilità del contatto con le caratteristiche del bundle, come ad esempio la sua dimensione ({\bf SOB}), e mette in pratica le politiche di instradamento scelte. L'esempio più banale di questa verifica è quindi verificare che la capacità trasmissiva rimasta nel contatto sia compatibile con la dimensione del bundle, che è l'implementazione di questo lavoro. Logiche più complesse saranno poi proposte nel capitolo finale dedicato agli sviluppi futuri, con particolare attenzione alla congestione dei nodi. Se un contatto non è considerato valido si passa semplicemente al successivo, altrimenti si aggiunge al {\bf NuovoPercorso} che si sta creando ({\it riga 5}). A questo punto rimane da capire se con questo contatto appena aggiunto si è arrivati a trovare un percorso valido o c'è il bisogno di ripetere il processo iterativamente. Il flusso si biforca quindi al blocco {\bf if - else} di {\it riga 6} che aggiunge il {\bf Nuovo percorso} all'insieme di {\bf TuttiPercorsi} validi nel caso il contatto sotto esame sia un HotSpot, altrimenti ({\bf else}) ({\it riga 10}), richiama ricorsivamente questa funzione. Particolare attenzione va dedicata a quali parametri riceve la chiamata ricorsiva. L'indirizzo che viene passato è quello dell'altro nodo con cui si è in contatto, perché ci si è idealmente spostati di nodo nell'albero, e questo diventa nodo radice del sotto albero e quindi la nuova destinazione. La strada invece dalla nuova radice dell'albero alla radice originale (il ColdSpot) è contenuta nel {\bf NuovoPercorso}, che diventa il {\it finoAQui} della nuova chiamata ricorsiva. Infine il nuovo {\bf TOV} deve essere per forza essere l'istante di inizio del contatto che collega i due nodi, in modo che i dati riescano ad arrivare in tempo. 
		
		L'algoritmo quindi trova una moltitudine di possibili percorsi che a fine computazione, cioè quando tutti i possibili contatti validi al ColdSpot sono stati presi in considerazione, si possono trovare nella struttura {\bf TuttiPercorsi}. Notare come selezionando i contatti alla destinazione tra il tempo attuale e il {\bf TOV} possa anche produrre un insieme vuoto se il tempo massimo di consegna è troppo stringente, diventando impossibile trovare una catena di contatti validi fino ad un HotSpot. Questo può succedere per limiti fisici temporali, oppure anche, come successo nelle simulazioni, i contatti che potevano essere sfruttati erano già saturi di bundle da trasferire, quindi privi di banda disponibile. Nel caso generale però un gruppo di percorsi sia effettivamente trovato c'è la necessità di decidere quale di questi verrà effettivamente confermato e allegato nell'header del bundle DTN. La scelta è rimandata ad una delle funzioni di supporto menzionate in precedenza su cui è superfluo soffermarsi essendo in questo stato piuttosto banale, scegliendo semplicemente il percorso più veloce. In futuri sviluppi c'è la possibilità che i criteri di scelta diventino più complessi, magari anche dinamici, per risolvere problemi di saturazione o energetici dei nodi. Per adesso si ragioni sulla qualità del percorso calcolato in termini di velocità di consegna. Data la possibilità di un'eventuale evoluzione in una rete a contatti multipli, è necessario ragionare sul tempo di fine dei contatti, termine ultimo per cui dati possono essere scambiati. Alla destinazione, questo istante segna il tempo di consegna di un determinato percorso. Essendo che presi in considerazione i contatti alla destinazione, da quelli attivi al tempo della creazione del bundle fino al {\bf TOV}, si può concludere che, {\bf al momento del calcolo del percorso}, il {\bf percorso con il contatto a destinazione dal tempo di fine minore è il percorso più veloce possibile.}
		
		Dopo che un percorso è stato scelto, una routine finale si occupa di aggiornare la Contact Table con il consumo di banda dato dal passagio del bundle per i vari contatti.

		
	\chapter{Risultati simulazione e analisi delle prestazioni}
		
		\section{Simulatore}
		Per investigare il comportamento della rete si è scelto il simulatore di rete ns-3. 
		ns-3 è un simulatore ad eventi discreti, vale a dire che il sistema è rappresentato, nella sua evoluzione nel tempo, con variabili che cambiano istantaneamente il loro valore in ben definiti istanti di tempo. L'avanzamento di quest'ultimo salta da un evento ad un altro, ignorando i periodi di inattività. \'E un potente strumento analizzare la progettazione di protocolli e interazioni tra gli stessi. Rappresenta una grande opportunità per la ricerca permettendo di studiare il comportamento di reti reali dai costi proibitivi o non immediatamente realizzabili, come ad esempio la nostra rete DTN. Altre ragioni per usare ns-3 sono la possibilità di avere un comportamento riproducibile e sfruttare i modelli di rete disponibili per impararne il funzionamento. Nato dalle ceneri di ns-2, si è posto dal principio lo scopo generale di essere {\it open-source}, estensibile e mirato alla ricerca e all'insegnamento.  Esistono molti simulatori di rete alternativi, esporremo qui alcune caratteristiche che distinguono ns-3 dagli altri strumenti.
		
		\begin{itemize}
			\item ns-3 è progettato come un{\bf set di librerie} che possono essere combinate tra loro e con altre librerie esterne. Mentre altre piattaforme forniscono una singola interfaccia utente usata per portare avanti ogni tipo di lavoro, ns-3 permette di poter usare diversi strumenti di visualizzazione e analisi di dati esterni
			
			\item Anche se principalmente usato su piattaforme Linux, esiste il supporto per FreeDSB e Cygwin per macchine Windows. Supporto nativo per Visual Studio è stato rilasciato in forma sperimentale. 
		\end{itemize}
		
		Lo sviluppo del simulatore è diviso in gruppi differenti, ma le linee guida seguenti sono valide in generale con lo scopo di produrre uno strumento di successo.
		\begin{itemize}
			\item {\bf Compatibilità}, essendo il codice basato largamente su simulatori esistenti, come ns-2, GTNetS e altri
			\item {\bf Scalabilità}, mentre ns-2 era un simulatore sequenziale con una singola esecuzione su un singolo processore, ns-3 può essere utilizzato per simulazioni distribuite e parallele. 
		\end{itemize}

		Infine un riassunto delle linee guida su cui il team di progetto si fa strada.
		
		\begin{itemize}
			\item {\bf Orientato agli oggetti.} Un simulatore di rete con lo scopo di essere usato dalla comunità di ricerca deve essere facilmente estensibile per includere nuovi protocolli, modifiche degli attuali esistenti o nuovi tipi di instradamento. Per questo gli sviluppatori hanno deciso di portare avanti la scelta già intrapresa con ns-2 di creare una gerarchia di classi C++.
			
			\item {\bf Realismo.} Il progetto del simulatore deve permettere di avvicinarsi molto al comportamento di reti reali. Ad esempio oggetti rappresentati gli applicativi dovrebbero interagire con i protocolli di livello quattro in modo simile a quelli reali.
			
			\item {\bf Efficienza di memoria.} Il simulatore supporta sia flussi {\it data-less} che flussi {\it data-full}. In altre parole è possibile risparmiare memoria essendo che molto spesso i dati trasportati non hanno significato nel contesto di simulazione e possono essere astratti via.
			
			\item {\bf Output configurabile.} Anche per andare incontro ad esigenze di simulazioni di grande portata, i dati da raccogliere sono altamente configurabili a seconda delle esigenze.
			
			\item {\bf Statistiche.} Il simulatore include strumenti per creare grafici ed estrapolare dati, in modo da aiutare la caratterizzazione dei risultati di simulazione.
		\end{itemize}
		
		\section{Simulazione della rete} \label{simRete}
		Lo scopo quindi è quello di modellare la nostra rete sul simulatore, cercando di evitare il più possibile discrepanze con la teoria esposta. Purtroppo però per alcune limitazioni operative di ns-3 per quanto riguarda le comunicazioni satellitare e le reti DTN, si è dovuti andare incontro ad alcune approssimazioni per non pesare troppo sulla semplicità e sui tempi di sviluppo. L'elenco seguente raccoglie tutte caratteristiche progettuali adottate per ricostruire la nostra architettura di rete sul simulatore. 
		
		\begin{itemize}
			\item I collegamenti tra HotSpot e Nodo Centrale e anche i collegamenti tra ColdSpot e nodi rurali sono implementati tramite i moduli Ethernet e TCP/IP di ns-3.
			
			\item Siccome che i collegamenti satellitari e relativi protocolli specializzati (LTP) non sono ancora stati implementati in ns-3, il collegamento radio è stato approssimato con una rete WiFi. Definendo le interfacce dei nanosatelliti e delle basi di terra con impostazioni particolari è possibile permettere la trasmissione di bundle su distanze molto maggiori delle normali reti WiFi. Il livello di rete invece è un normale IP. Per quanto riguarda il livello di trasporto invece si è sopperiti alla mancanza del Licklider Transmission Protocol (LTP) con il modulo UDP. Per emulare il meccanismo di ritrasmissione LTP, mancante per natura nell'UDP, lo si è implementato a livello applicativo nel bundle DTN. L'accoppiata quindi di UDP e ACK fornito dal Bundle Layer si comporta similmente all'LTP, dove il mittente mantiene una copia dei bundle inviati fintanto che non riceve una risposta positiva dal destinatario di avvenuta ricezione. 
			
			\item Per creare una comunicazione radio bidirezionale è stato necessario definire due interfacce radio per ogni nodo wireless, una in {\it Downlink} e una in {\it Uplink}. Questo sebbene ns-3 contenesse un modulo CSMA full-duplex, essendo che si aveva bisogno di un WiFi full-duplex. La soluzione quindi è stata di dotare i nodi con due distinte interfacce Wifi dalle stesse caratteristiche fisiche. Ad esempio un HotSpot mandando un dato ad un nanosatellite userà l'interfaccia di {\it Uplink}, questo riceverà i dati tramite l'interfaccia di {\it Uplink} ma risponderà tramite l'interfaccia di {\it Downlink}. Infine l'HotSpot riceverà la risposta tramite l'interfaccia di {\it Downlink}.
			%SERVE RIFERIMENTO A QUALCHE PAPER
			\item L'header DTN è piuttosto diverso da quello canonico, in primo luogo per la parte di SCGR introdotta in \ref{concDet}, in generale semplificato di tutte le parti non necessarie per le simulazioni, minimizzando l'impatto di {\it overhead}.
			
			\vspace{25pt}
			\begin{bytefield}[bitwidth=0.5em]{64}
				\bitheader{0, 8, 16, 24, 32, 40, 48, 56, 64} \\
				\bitbox{32}{Destination EID}  & \bitbox{32}{Source EID} \\
				\bitbox{32}{Sequence Number} & \bitbox{32}{Payload Size} \\
				\bitbox{32}{Source Timestamp} & \bitbox{8}{Type} & \bitbox{8}{N Hops} \\
				
				\begin{rightwordgroup}{Paths \\ hops}
					\bitbox{32}{Contact Start 1} & \bitbox{32}{Next Hop EID 1} \\
					\bitbox{32}{Contact Start 2} & \bitbox{32}{Next Hop EID 2} \\
					\wordbox[]{1}{$\vdots$} \\[1ex]
					\bitbox{32}{Contact Start $N$} & \bitbox{32}{Next Hop EID $N$}
				\end{rightwordgroup}
				
			\end{bytefield}
			\vspace{25pt}
			
			Nel dettaglio, i primi due campi contengono una stringa che identifica destinazione e sorgente. Il Sequance Number differenzia ogni bundle generato con un numero univoco. Il Payload Size indica la quantità di dati trasportati, espressi in byte. Source Timestamp contiene l'istante in cui il bundle è stato generato. Il campo Type al momento è definito per tre valori diversi: 
			\begin{itemize}
				\item {\bf 0} Data bundle, trasporta dati
				\item {\bf 1} ACK bundle, conferma di avvenuta ricezione
				\item {\bf 2} Status bundle, generiche informazioni di servizio
			\end{itemize}
			
			Quindi se un bundle dati arriva ad un nodo DTN questo è seguito da un bundle ACK nella direzione opposta per comunicare l'avvenuta ricezione. Questo bundle porta lo stesso Sequence Number del bundle dati che l'ha generato. Per implementare questo meccanismo ogni nodo tiene una lista dei socket in trasmissione attivi, un socket per ogni bundle. Ogni socket attivo ha un timeout, se allo scadere di questo non viene ricevuto l'ack il bundle viene inviato nuovamente, altrimenti si elimina il socket dalla lista. 
				
		\end{itemize}
			
		\section{Scenari di simulazione}
		%i diversi scenari spiegati e motivati
		Gli scenari sono la caratterizzazione di una specifica simulazione in termini di quantità di nodi e la loro disposizione. Per ragioni pratiche di tempi simulazione e capacità di calcolo si mantiene il numero dei nodi nell'ordine delle decine.
		
		\begin{itemize}
			\item {\bf Scenario UNO:} 8 HotSpot, 24 nanosatelliti, 16 ColdSpot
			\item {\bf Scenario DUE:} 16 HotSpot, 24 nanosatelliti, 32 ColdSpot
			\item {\bf Scenario TRE:} 8 HotSpot, 42 nanosatelliti, 16 ColdSpot
		\end{itemize}
		
		Scenario UNO è il riferimento per gli altri due scenari, dove scenario DUE studia le prestazioni per un aumento delle stazioni di terra, mentre scenario TRE aumenta il numero di nanosatelliti in orbita.
		
		%IMMAGINI CON POSIZIONI DELLE STAZIONI DI TERRA
		
		Quindi scenario UNO e DUE condividono la stessa costellazione di 24 nanosatelliti equamente distribuiti su 4 piani orbitali. Le figure XX e XX mostrano le differenti disposizioni sul pianeta delle stazioni di terra. Notare come gli HotSpot sono posizionati in zone civilizzate e connesse e invece i ColdSpot sono disseminati in zone desertiche, parchi naturali, isole e insediamenti remoti. 
		Lo scenario TRE invece propone una differente costellazione, con 42 nanosatelliti distribuiti su 6 piani orbitali. Le stazioni di terra sono nelle stesse posizioni dello scenario UNO.
		
		Per quanto riguarda i flussi di traffico simulati su questi scenari si è stabilito uno schema composto da cinque flussi di traffico. La denominazione {\bf RN} sta per Rural Node e la distinzione tra flussi fa riferimento alla diversa quantità di nodi rurali di destinazione. I cinque diversi flussi quindi sono: {\bf 1RN, 2RN, 4RN, 8RN, 16RN}. Per ogni nodo rurale partono 1000 bundle che trasporta 50Kb di dati, generati uno al secondo a partire dal dall'istante zero di simulazione. Questa trama punta a farci capire come i differenti scenari reagiscono a intensità di traffico crescenti.
		
		Infine tutti e tre gli scenari sono descritti dai seguenti parametri che rimangono invariati. Le orbite hanno un raggio di 6652655 metri, i satelliti quindi orbitano a 281655 metri dal suolo. Ogni nanosatellite è un CubeSat con una massa di 1.33Kg. Con questi parametri si ottengono periodi orbitali di circa 90 minuti.
		
		Le interfacce sono di tipo WiFi 802.11b a 2.4GHz, la velocità di trasmissione è di 63052 Bps. I protocolli superiori sono quelli esposti in \ref{simRete}.
		
		In modo da fornire un termine di paragone di riferimento per i dati raccolti con algoritmo di instradamento SCGR, si sono simulati gli stessi scenari e flussi con una scelta di instradamento statica. In pratica ad ogni zona rurale di destinazione è stato associato in modo statico un HotSpot che inoltrava i dati al primo nanosatellite disponibile. Questo nanosatellite manteneva i dati fintanto che non si trovava in contatto con la zona rurale di destinazione. Ci si riferirà a questo termine di paragone con il termine {\bf "Static"}, contrapposto a {\bf "SCGR"}, cioè la soluzione proposta in questa tesi.
			
		\section{Risultati}
		%tabelle e grafici con i risultati
		
	
	\chapter{Conclusione e sviluppi futuri}
	%riassunto dei risultati e idee future di sviluppo
	%contatti multipli e ponti radio
	%gestione delle scelte di routing in modo dinamico
	Partendo dallo scopo di creare una rete globale capace di fornire servizi Internet ad utenti in zone rurali si è arrivati a definire un rete DTN nanosatellitare in grado di superare la mancanza di un collegamento persistente tra sorgente e destinazione. I nanosatelliti scelti si rifanno allo standard CubeSat, consentendo un dispiego della rete a costi ridotti e in tempi di sviluppo relativamente brevi. Si è poi ragionato sulla possibilità di predire in modo deterministico l'evoluzione della topologia della rete creando un registro adatto per tenere traccia dei contatti tra nodi, la Contact Table. 
	Infine il contributo dato da questo lavoro di tesi si è incentrato sullo sfruttare le informazioni fornite dalla Contact Table per produrre un algoritmo di instradamento deterministico, applicato alla sorgente. Il prodotto di questo lavoro è chiamato SCGR, {\it Source Contact Graph Routing}, e rappresenta un'evoluzione marcata del concetto proposto in \cite{burleigh2010contact}.
	
	Le future indagini in questo ambito di ricerca sono molteplici, ma molti di questi possono essere integrati nella logica di lavoro introdotta da questa tesi senza particolare sforzo. Due esempi dei limiti della rete non modellati al momento sono l'occupazione di memoria e l'energia disponibili hai nodi, con particolare attenzione ai nanosatelliti che per natura non dispongono di risorse considerevoli. Entrambi questi valori possono essere gestiti in modo simile alla banda rimanente dei contatti, vale a dire aggiornati alla sorgente e tenuti in considerazione mentre l'algoritmo SCGR ha bisogno di sapere se un contatto può essere ritenuto valido. In pratica oltre a controllare se il contatto dispone ancora di sufficiente banda si controllerà anche se il buffer sul nanosatellite ha abbastanza memoria o se l'energia disponibile è sufficiente per trasmettere, dando ad esempio un peso energetico ad ogni operazione. Se tutte le verifiche vanno a buon fine, si potrà confermare il trasferimento in quel contatto e in seguito aggiornare tutte le strutture tenendo conto di quel trasferimento.

	Tutto questo sarebbe da integrare con il flusso opposto a quello indagato in questo lavoro, dai nodi rurali al Nodo Centrale.
	
	In questo ambito inoltre potrebbe essere utile integrare un sistema di QoS, {\it Quality of Service},  che gestisca priorità ed eviti a priori saturazioni dei nodi. La scelta ad esempio di scegliere il percorso più veloce potrebbe essere rimpiazzata da un algoritmo che scelga il percorso in modo da distribuire in modo bilanciato il carico su tutte le risorse della rete. 
	
	Infine c'è la necessità di introdurre un meccanismo che sappia reagire di fronte agli imprevisti, come ad esempio un canale disturbato che non permette di fruttare la capacità di trasferimento del contatto come previsto. Questo genere di casualità rappresenta un punto di debolezza del sistema SCGR andando a minare la base concettuale di una rete deterministica e c'è la necessità di studiare una soluzione concreta.
	
	Altro sviluppo da indagare, a lato del sistema SCGR, è la possibilità di avere contatti multipli, che in primo luogo aumenterebbero le opportunità di contatto e infine aprirebbero alla possibilità a ponti radio capaci di trasferimenti immediati, anche se solo tra nanosatelliti, questa possibilità combinata alla natura DTN della rete potrebbe risultare in miglioramenti prestazionali non indifferenti, soprattutto negli scenari più densi di nodi.
	
	
	\bibliography{references}
	
\end{document}
